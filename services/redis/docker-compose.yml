services:
  redis:
    container_name: redis
    restart: unless-stopped
    image: redis:alpine

    networks:
      - traefik
    entrypoint: redis-server --requirepass ${REDIS_PASSWORD}   
    labels:
      - "traefik.enable=true"  

      - "traefik.tcp.routers.redis.entrypoints=redis"
      - "traefik.tcp.routers.redis.rule=HostSNI(`*`)"
      - "traefik.tcp.services.redis.loadbalancer.server.port=6379"
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 30s
    volumes:
      - ./services/redis/data:/data
